{{- /* Comments area start */ -}}
{{- if (.Param "comments") }}
<div id="giscus-container" style="margin-top: 3rem; padding-top: 2rem; border-top: 2px solid #f0f0f0;">
    <h3 style="font-size: 1.5rem; margin-bottom: 1.5rem; color: #2c3e50;">ğŸ’¬ è¯„è®º</h3>
    {{- if and .Site.Params.giscus.repo .Site.Params.giscus.repoId }}
    <div id="giscus"></div>
    <script src="https://giscus.app/client.js"
            data-repo="{{ .Site.Params.giscus.repo }}"
            data-repo-id="{{ .Site.Params.giscus.repoId }}"
            data-category="{{ .Site.Params.giscus.category }}"
            data-category-id="{{ .Site.Params.giscus.categoryId }}"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="light"
            data-lang="zh-CN"
            crossorigin="anonymous"
            async>
    </script>
    <script>
    // æ›´æ–°è¯„è®ºæ•°
    window.addEventListener('message', function(event) {
        if (event.origin !== 'https://giscus.app') return;
        if (event.data.giscus && event.data.giscus.discussion) {
            const commentCount = event.data.giscus.discussion.totalCommentCount || 0;
            const commentCountEl = document.getElementById('comment_count');
            if (commentCountEl) {
                commentCountEl.textContent = commentCount;
            }
        }
    });
    </script>
    {{- else }}
    <p style="color: #999; text-align: center; padding: 2rem;">è¯·åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® Giscus è¯„è®ºç³»ç»Ÿ</p>
    {{- end }}
</div>
{{- end }}
{{- /* Comments area end */ -}}
